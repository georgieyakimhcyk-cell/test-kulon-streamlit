import streamlit as st

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
st.set_page_config(
    page_title="–¢–µ—Å—Ç: –ó–∞–∫–æ–Ω –ö—É–ª–æ–Ω–∞",
    page_icon="‚ö°",
    layout="centered"
)

# –í–æ–ø—Ä–æ—Å—ã —Ç–µ—Å—Ç–∞ (—Å –ò–°–ü–†–ê–í–õ–ï–ù–ù–´–ú 5-–º –≤–æ–ø—Ä–æ—Å–æ–º)
questions = [
    {
        "question": "–ö–∞–∫ —á–∏—Ç–∞–µ—Ç—Å—è –∑–∞–∫–æ–Ω –ö—É–ª–æ–Ω–∞?",
        "options": [
            "–°–∏–ª–∞ –ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª—å–Ω–∞ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—é –∑–∞—Ä—è–¥–æ–≤ –∏ –æ–±—Ä–∞—Ç–Ω–æ –ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª—å–Ω–∞ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—é",
            "–°–∏–ª–∞ –ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª—å–Ω–∞ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—é –∑–∞—Ä—è–¥–æ–≤ –∏ –æ–±—Ä–∞—Ç–Ω–æ –ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª—å–Ω–∞ –∫–≤–∞–¥—Ä–∞—Ç—É —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è –º–µ–∂–¥—É –Ω–∏–º–∏",
            "–°–∏–ª–∞ –ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª—å–Ω–∞ —Å—É–º–º–µ –∑–∞—Ä—è–¥–æ–≤ –∏ –ø—Ä—è–º–æ –ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª—å–Ω–∞ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—é",
            "–°–∏–ª–∞ –ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª—å–Ω–∞ –∫–≤–∞–¥—Ä–∞—Ç—É –∑–∞—Ä—è–¥–æ–≤ –∏ –Ω–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è"
        ],
        "correct": 1
    },
    {
        "question": "–í –∫–∞–∫–∏—Ö –µ–¥–∏–Ω–∏—Ü–∞—Ö –∏–∑–º–µ—Ä—è–µ—Ç—Å—è —ç–ª–µ–∫—Ç—Ä–∏—á–µ—Å–∫–∏–π –∑–∞—Ä—è–¥ –≤ –°–ò?",
        "options": [
            "–ê–º–ø–µ—Ä (–ê)",
            "–í–æ–ª—å—Ç (–í)",
            "–ö—É–ª–æ–Ω (–ö–ª)",
            "–§–∞—Ä–∞–¥ (–§)"
        ],
        "correct": 2
    },
    {
        "question": "–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç k –≤ –∑–∞–∫–æ–Ω–µ –ö—É–ª–æ–Ω–∞ (–≤ –≤–∞–∫—É—É–º–µ) –ø—Ä–∏–±–ª–∏–∑–∏—Ç–µ–ª—å–Ω–æ —Ä–∞–≤–µ–Ω:",
        "options": [
            "1",
            "9¬∑10‚Åπ –ù¬∑–º¬≤/–ö–ª¬≤",
            "8,85¬∑10‚Åª¬π¬≤ –ö–ª¬≤/(–ù¬∑–º¬≤)",
            "6,67¬∑10‚Åª¬π¬π –ù¬∑–º¬≤/–∫–≥¬≤"
        ],
        "correct": 1
    },
    {
        "question": "–ö–∞–∫ –∏–∑–º–µ–Ω–∏—Ç—Å—è —Å–∏–ª–∞ –∫—É–ª–æ–Ω–æ–≤—Å–∫–æ–≥–æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –¥–≤—É—Ö —Ç–æ—á–µ—á–Ω—ã—Ö –∑–∞—Ä—è–¥–æ–≤, –µ—Å–ª–∏ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É –Ω–∏–º–∏ —É–≤–µ–ª–∏—á–∏—Ç—å –≤ 2 —Ä–∞–∑–∞?",
        "options": [
            "–£–≤–µ–ª–∏—á–∏—Ç—Å—è –≤ 2 —Ä–∞–∑–∞",
            "–£–º–µ–Ω—å—à–∏—Ç—Å—è –≤ 2 —Ä–∞–∑–∞",
            "–£–≤–µ–ª–∏—á–∏—Ç—Å—è –≤ 4 —Ä–∞–∑–∞",
            "–£–º–µ–Ω—å—à–∏—Ç—Å—è –≤ 4 —Ä–∞–∑–∞"
        ],
        "correct": 3
    },
    {
        "question": "–ß—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç –∑–Ω–∞–∫ ¬´–º–∏–Ω—É—Å¬ª –≤ –∑–∞–∫–æ–Ω–µ –ö—É–ª–æ–Ω–∞ –ø—Ä–∏ –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–µ –∑–∞—Ä—è–¥–æ–≤?",
        "options": [
            "–°–∏–ª–∞ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–π, –∑–Ω–∞—á–∏—Ç –æ–Ω–∞ –∏—Å—á–µ–∑–∞–µ—Ç",
            "–ó–∞—Ä—è–¥—ã –æ—Ç—Ç–∞–ª–∫–∏–≤–∞—é—Ç—Å—è (–æ–¥–Ω–æ–∏–º—ë–Ω–Ω—ã–µ)",
            "–ó–∞—Ä—è–¥—ã –ø—Ä–∏—Ç—è–≥–∏–≤–∞—é—Ç—Å—è (—Ä–∞–∑–Ω–æ–∏–º—ë–Ω–Ω—ã–µ)",  # –≠–¢–û –ü–†–ê–í–ò–õ–¨–ù–´–ô –û–¢–í–ï–¢
            "–û—à–∏–±–∫–∞ –≤ —Ä–∞—Å—á—ë—Ç–∞—Ö, –∑–∞—Ä—è–¥—ã –≤—Å–µ–≥–¥–∞ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã"
        ],
        "correct": 2  # –ò–°–ü–†–ê–í–õ–ï–ù–û: —Ç–µ–ø–µ—Ä—å —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç
    },
    {
        "question": "–ï—Å–ª–∏ –∑–∞—Ä—è–¥—ã —É–≤–µ–ª–∏—á–∏—Ç—å –≤ 3 —Ä–∞–∑–∞ –∫–∞–∂–¥—ã–π, –Ω–µ –º–µ–Ω—è—è —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è, —Å–∏–ª–∞ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è:",
        "options": [
            "–£–≤–µ–ª–∏—á–∏—Ç—Å—è –≤ 3 —Ä–∞–∑–∞",
            "–£–≤–µ–ª–∏—á–∏—Ç—Å—è –≤ 6 —Ä–∞–∑",
            "–£–≤–µ–ª–∏—á–∏—Ç—Å—è –≤ 9 —Ä–∞–∑",
            "–ù–µ –∏–∑–º–µ–Ω–∏—Ç—Å—è"
        ],
        "correct": 2
    },
    {
        "question": "–ó–∞–∫–æ–Ω –ö—É–ª–æ–Ω–∞ —Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤ –¥–ª—è:",
        "options": [
            "–õ—é–±—ã—Ö —Ç–µ–ª —Å –ª—é–±—ã–º–∏ —Ä–∞–∑–º–µ—Ä–∞–º–∏",
            "–¢–æ–ª—å–∫–æ –¥–ª—è –Ω–µ–ø–æ–¥–≤–∏–∂–Ω—ã—Ö —Ç–æ—á–µ—á–Ω—ã—Ö –∑–∞—Ä—è–¥–æ–≤",
            "–¢–æ–ª—å–∫–æ –¥–ª—è –¥–≤–∏–∂—É—â–∏—Ö—Å—è –∑–∞—Ä—è–¥–æ–≤",
            "–î–ª—è –ø—Ä–æ–≤–æ–¥–Ω–∏–∫–æ–≤ —Å —Ç–æ–∫–æ–º"
        ],
        "correct": 1
    },
    {
        "question": "–ö—Ç–æ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–∏–ª –∑–∞–∫–æ–Ω –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –∑–∞—Ä—è–¥–æ–≤?",
        "options": [
            "–ò—Å–∞–∞–∫ –ù—å—é—Ç–æ–Ω",
            "–ê–ª–µ—Å—Å–∞–Ω–¥—Ä–æ –í–æ–ª—å—Ç–∞",
            "–®–∞—Ä–ª—å –ö—É–ª–æ–Ω",
            "–ú–∞–π–∫–ª –§–∞—Ä–∞–¥–µ–π"
        ],
        "correct": 2
    },
    {
        "question": "–î–∏—ç–ª–µ–∫—Ç—Ä–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–Ω–∏—Ü–∞–µ–º–æ—Å—Ç—å —Å—Ä–µ–¥—ã Œµ –≤ –∑–∞–∫–æ–Ω–µ –ö—É–ª–æ–Ω–∞ —É—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –∫–∞–∫:",
        "options": [
            "–£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —Å–∏–ª—É –≤ Œµ —Ä–∞–∑",
            "–£–º–µ–Ω—å—à–∞–µ—Ç —Å–∏–ª—É –≤ Œµ —Ä–∞–∑",
            "–ù–µ –≤–ª–∏—è–µ—Ç –Ω–∞ —Å–∏–ª—É",
            "–ú–µ–Ω—è–µ—Ç –∑–Ω–∞–∫ —Å–∏–ª—ã"
        ],
        "correct": 1
    },
    {
        "question": "–î–≤–∞ –∑–∞—Ä—è–¥–∞ +q –∏ -q –Ω–∞—Ö–æ–¥—è—Ç—Å—è –Ω–∞ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–∏ r. –ö—É–¥–∞ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∞ —Å–∏–ª–∞, –¥–µ–π—Å—Ç–≤—É—é—â–∞—è –Ω–∞ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π –∑–∞—Ä—è–¥ —Å–æ —Å—Ç–æ—Ä–æ–Ω—ã –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–≥–æ?",
        "options": [
            "–û—Ç –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–≥–æ –∑–∞—Ä—è–¥–∞ (–æ—Ç—Ç–∞–ª–∫–∏–≤–∞–Ω–∏–µ)",
            "–ö –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–º—É –∑–∞—Ä—è–¥—É (–ø—Ä–∏—Ç—è–∂–µ–Ω–∏–µ)",
            "–ü–µ—Ä–ø–µ–Ω–¥–∏–∫—É–ª—è—Ä–Ω–æ –ª–∏–Ω–∏–∏, —Å–æ–µ–¥–∏–Ω—è—é—â–µ–π –∑–∞—Ä—è–¥—ã",
            "–°–∏–ª–∞ —Ä–∞–≤–Ω–∞ –Ω—É–ª—é"
        ],
        "correct": 1
    }
]

def main():
    # –ó–∞–≥–æ–ª–æ–≤–æ–∫
    st.markdown("""
    <style>
    .main-title {
        text-align: center;
        font-size: 3rem;
        font-weight: 800;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        margin-bottom: 0;
    }
    .sub-title {
        text-align: center;
        color: #666;
        font-size: 1.2rem;
        margin-bottom: 2rem;
    }
    </style>
    """, unsafe_allow_html=True)
    
    st.markdown('<p class="main-title">‚ö° –ó–∞–∫–æ–Ω –ö—É–ª–æ–Ω–∞ ‚ö°</p>', unsafe_allow_html=True)
    st.markdown('<p class="sub-title">–ü—Ä–æ–≤–µ—Ä—å —Å–≤–æ–∏ –∑–Ω–∞–Ω–∏—è –ø–æ —ç–ª–µ–∫—Ç—Ä–æ—Å—Ç–∞—Ç–∏–∫–µ</p>', unsafe_allow_html=True)

    # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–µ—Å—Å–∏–∏
    if 'q_index' not in st.session_state:
        st.session_state.q_index = 0
        st.session_state.score = 0
        st.session_state.answers = []
        st.session_state.test_finished = False
        st.session_state.answer_given = False

    # –ï—Å–ª–∏ —Ç–µ—Å—Ç –∑–∞–∫–æ–Ω—á–µ–Ω, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
    if st.session_state.test_finished:
        show_results()
        return

    # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–µ–∫—É—â–∏–π –≤–æ–ø—Ä–æ—Å
    show_question()

def show_question():
    """–û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —Ç–µ–∫—É—â–∏–π –≤–æ–ø—Ä–æ—Å"""
    total = len(questions)
    current = st.session_state.q_index
    
    # –ü—Ä–æ–≥—Ä–µ—Å—Å
    st.progress((current) / total)
    st.markdown(f"### –í–æ–ø—Ä–æ—Å {current + 1} –∏–∑ {total}")
    
    # –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –≤–æ–ø—Ä–æ—Å
    q = questions[current]
    st.markdown(f"**{q['question']}**")
    
    # –í–∞—Ä–∏–∞–Ω—Ç—ã –æ—Ç–≤–µ—Ç–æ–≤
    answer = st.radio(
        "–í—ã–±–µ—Ä–∏—Ç–µ –æ—Ç–≤–µ—Ç:",
        q['options'],
        key=f"radio_{current}",
        disabled=st.session_state.answer_given
    )
    
    # –ö–Ω–æ–ø–∫–∞ –æ—Ç–≤–µ—Ç–∞
    if not st.session_state.answer_given:
        if st.button("‚úÖ –û—Ç–≤–µ—Ç–∏—Ç—å", type="primary", use_container_width=True):
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º –æ—Ç–≤–µ—Ç
            correct = q['options'][q['correct']]
            is_correct = (answer == correct)
            
            if is_correct:
                st.session_state.score += 1
                st.success("‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ!")
            else:
                st.error(f"‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ. –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç: **{correct}**")
            
            # –°–æ—Ö—Ä–∞–Ω—è–µ–º –æ—Ç–≤–µ—Ç
            st.session_state.answers.append({
                'question': q['question'],
                'user_answer': answer,
                'correct': correct,
                'is_correct': is_correct
            })
            
            st.session_state.answer_given = True
            st.rerun()
    else:
        # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É "–î–∞–ª–µ–µ"
        if st.button("‚è© –î–∞–ª–µ–µ", type="primary", use_container_width=True):
            if st.session_state.q_index < total - 1:
                # –ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ —Å–ª–µ–¥—É—é—â–µ–º—É –≤–æ–ø—Ä–æ—Å—É
                st.session_state.q_index += 1
                st.session_state.answer_given = False
            else:
                # –¢–µ—Å—Ç –∑–∞–∫–æ–Ω—á–µ–Ω
                st.session_state.test_finished = True
            st.rerun()

def show_results():
    """–û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∞"""
    total = len(questions)
    score = st.session_state.score
    
    # –ü—Ä–∞–∑–¥–Ω–∏—á–Ω–∞—è –∞–Ω–∏–º–∞—Ü–∏—è
    st.balloons()
    
    # –†–µ–∑—É–ª—å—Ç–∞—Ç
    col1, col2, col3 = st.columns([1, 2, 1])
    with col2:
        st.markdown(f"""
        <div style='text-align: center; background: linear-gradient(135deg, #667eea20, #764ba220); 
                    padding: 30px; border-radius: 20px; margin: 20px 0;'>
            <h1 style='font-size: 4rem; margin: 0;'>{score}/{total}</h1>
            <p style='font-size: 2rem; margin: 0; color: #667eea;'>
                {score/total*100:.1f}%
            </p>
        </div>
        """, unsafe_allow_html=True)
    
    # –í–µ—Ä–¥–∏–∫—Ç
    percentage = score/total*100
    if percentage == 100:
        verdict = "üèÜ **–ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–æ!** –í—ã –∑–Ω–∞–µ—Ç–µ –∑–∞–∫–æ–Ω –ö—É–ª–æ–Ω–∞ –Ω–∞ –æ—Ç–ª–∏—á–Ω–æ!"
    elif percentage >= 80:
        verdict = "üåü **–û—Ç–ª–∏—á–Ω–æ!** –û—á–µ–Ω—å —Ö–æ—Ä–æ—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç!"
    elif percentage >= 60:
        verdict = "üìö **–•–æ—Ä–æ—à–æ.** –ù–æ –µ—Å—Ç—å –Ω–∞–¥ —á–µ–º –ø–æ—Ä–∞–±–æ—Ç–∞—Ç—å."
    elif percentage >= 40:
        verdict = "üìñ **–£–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–∏—Ç–µ–ª—å–Ω–æ.** –°—Ç–æ–∏—Ç –ø–æ–≤—Ç–æ—Ä–∏—Ç—å –º–∞—Ç–µ—Ä–∏–∞–ª."
    else:
        verdict = "üìï **–ü–ª–æ—Ö–æ.** –í–∞–º –Ω—É–∂–Ω–æ —Å–µ—Ä—å—ë–∑–Ω–æ –∏–∑—É—á–∏—Ç—å —Ç–µ–º—É."
    
    st.info(verdict)
    
    # –†–∞–∑–±–æ—Ä –æ—Ç–≤–µ—Ç–æ–≤
    with st.expander("üìã –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤—Å–µ –æ—Ç–≤–µ—Ç—ã"):
        for i, ans in enumerate(st.session_state.answers, 1):
            if ans['is_correct']:
                st.markdown(f"**{i}. ‚úÖ {ans['question']}**")
                st.markdown(f"–í–∞—à –æ—Ç–≤–µ—Ç: **{ans['user_answer']}**")
            else:
                st.markdown(f"**{i}. ‚ùå {ans['question']}**")
                st.markdown(f"–í–∞—à –æ—Ç–≤–µ—Ç: {ans['user_answer']}")
                st.markdown(f"–ü—Ä–∞–≤–∏–ª—å–Ω–æ: **{ans['correct']}**")
            st.markdown("---")
    
    # –ö–Ω–æ–ø–∫–∞ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞
    if st.button("üîÑ –ü—Ä–æ–π—Ç–∏ —Ç–µ—Å—Ç –∑–∞–Ω–æ–≤–æ", type="primary", use_container_width=True):
        # –û—á–∏—â–∞–µ–º —Å–µ—Å—Å–∏—é
        for key in ['q_index', 'score', 'answers', 'test_finished', 'answer_given']:
            if key in st.session_state:
                del st.session_state[key]
        st.rerun()

if __name__ == "__main__":
    main()
